import os
import sys
import pefile

try:
    for Arg in sys.argv:
        x=("/"+Arg)
        file_path =os.getcwd()
        file_path_exe = file_path + x
except OSError as e:
    print(e)

try:
    pe = pefile.PE(file_path_exe)
    for section in pe.sections:
        print ("Section:"+section.Name, "Virtual Address: "+hex(section.VirtualAddress),"Virtual Size: "+hex(section.Misc_VirtualSize), "Size of Raw Data: {} " .format(section.SizeOfRawData))
except OSError as e:
    print(e)
except pefile.PEFormatError as e:
    print("[-] PEFormatError: %s %e.value")

try:
    pe = pefile.PE(file_path_exe)
    for entry in pe.DIRECTORY_ENTRY_IMPORT:
        print entry.dll
        for function in entry.imports:
            print '\t',function.name
except OSError as e:
    print(e)
except pefile.PEFormatError as e:
    print("[-] PEFormatError: %s %e.value")

